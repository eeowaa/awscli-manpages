.\" Man page generated from reStructuredText.
.
.TH "AWS-S3-FAQ" "a" "" ""
.SH NAME
aws-s3-faq \- Frequented Asked Questions for Amazon S3 in the AWS CLI
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.sp
Below are common questions regarding the use of Amazon S3 in the AWS CLI.
.SH Q: DOES THE AWS CLI VALIDATE CHECKSUMS?
.sp
The AWS CLI will perform checksum validation for uploading and downloading
files in specific scenarios.
.SS Upload
.sp
The AWS CLI will calculate and auto\-populate the \fBContent\-MD5\fP header for
both standard and multipart uploads.  If the checksum that S3 calculates does
not match the \fBContent\-MD5\fP provided, S3 will not store the object and
instead will return an error message back the AWS CLI.  The AWS CLI will retry
this error up to 5 times before giving up.  On the case that any files fail to
transfer successfully to S3, the AWS CLI will exit with a non zero RC.
See \fBaws help return\-codes\fP for more information.
.sp
If the upload request is signed with Signature Version 4, then the AWS CLI uses the
\fBx\-amz\-content\-sha256\fP header as a checksum instead of \fBContent\-MD5\fP\&.
The AWS CLI will use Signature Version 4 for S3 in several cases:
.INDENT 0.0
.IP \(bu 2
You\(aqre using an AWS region that only supports Signature Version 4.  This
includes \fBeu\-central\-1\fP and \fBap\-northeast\-2\fP\&.
.IP \(bu 2
You explicitly opt in and set \fBsignature_version = s3v4\fP in your
\fB~/.aws/config\fP file.
.UNINDENT
.sp
Note that the AWS CLI will add a \fBContent\-MD5\fP header for both
the high level \fBaws s3\fP commands that perform uploads
(\fBaws s3 cp\fP, \fBaws s3 sync\fP) as well as the low level \fBs3api\fP
commands including \fBaws s3api put\-object\fP and \fBaws s3api upload\-part\fP\&.
.sp
If you want to verify the integrity of an object during upload, see \fI\%How can I check the integrity of an object uploaded to Amazon S3?\fP in the \fIAWS Knowledge Center\fP\&.
.SS Download
.sp
The AWS CLI will attempt to verify the checksum of downloads when possible,
based on the \fBETag\fP header returned from a \fBGetObject\fP request that\(aqs
performed whenever the AWS CLI downloads objects from S3.  If the calculated
MD5 checksum does not match the expected checksum, the file is deleted
and the download is retried.  This process is retried up to 3 times.
If a downloads fails, the AWS CLI will exit with a non zero RC.
See \fBaws help return\-codes\fP for more information.
.sp
There are several conditions where the CLI is \fInot\fP able to verify
checksums on downloads:
.INDENT 0.0
.IP \(bu 2
If the object was uploaded via multipart uploads
.IP \(bu 2
If the object was uploaded using server side encryption with KMS
.IP \(bu 2
If the object was uploaded using a customer provided encryption key
.IP \(bu 2
If the object is downloaded using range \fBGetObject\fP requests
.UNINDENT
.\" Generated by docutils manpage writer.
.
