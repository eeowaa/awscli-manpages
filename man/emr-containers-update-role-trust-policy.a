.\" Man page generated from reStructuredText.
.
.TH "EMR-CONTAINERS-UPDATE-ROLE-TRUST-POLICY" "a" "" ""
.SH NAME
emr-containers-update-role-trust-policy \- Updates the trust policy of given IAM role such that it can be used with Amazon EMR on EKS with the given namespace from the given EKS cluster
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH DESCRIPTION
.sp
Updates the trust policy of given IAM role such that it can be used with Amazon EMR on EKS with the given namespace from the given EKS cluster.
.INDENT 0.0
.TP
.B Note:
To use the IAM Role with Amazon EMR on EKS, OIDC identity provider also needs to be created for the EKS cluster.
This can be done using \fBeksctl utils associate\-iam\-oidc\-provider \-\-cluster <cluster_name> \-\-approve\fP command.
For information about installing or upgrading eksctl, see \fI\%Installing or upgrading eksctl\fP in the \fIAmazon EKS User Guide\fP\&.
.UNINDENT
.sp
The command would merge the existing trust policy of the role with the below trust policy:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
{
    "Version": "2012\-10\-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Principal": {
                "Federated": "arn:aws:iam::<AWS_ACCOUNT_ID>:oidc\-provider/<OIDC_PROVIDER>"
            },
            "Action": "sts:AssumeRoleWithWebIdentity",
            "Condition": {
                "StringLike": {
                    "<OIDC_PROVIDER>:sub": "system:serviceaccount:<NAMESPACE>:emr\-containers\-sa\-*\-*\-<AWS_ACCOUNT_ID>\-<BASE36_ENCODED_ROLE_NAME>"
                }
            }
        }
    ]
}
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Here:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
<AWS_ACCOUNT_ID> = AWS Account ID of the EKS cluster
<OIDC_PROVIDER> = OIDC Identity Provider for the EKS cluster
<NAMESPACE> = Namespace of the EKS cluster
<BASE36_ENCODED_ROLE_NAME> = Base36 encoded form of the IAM Role name
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
You can use the \fB\-\-dry\-run\fP option to print the merged trust policy document to stdout instead of updating the role trust policy directly.
.sp
See \(aqaws help\(aq for descriptions of global parameters.
.SH SYNOPSIS
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
  update\-role\-trust\-policy
\-\-cluster\-name <value>
\-\-namespace <value>
\-\-role\-name <value>
[\-\-iam\-endpoint <value>]
[\-\-dry\-run]
.ft P
.fi
.UNINDENT
.UNINDENT
.SH OPTIONS
.sp
\fB\-\-cluster\-name\fP (string)
Specify the name of the Amazon EKS cluster with which the IAM Role would be used.
.sp
\fB\-\-namespace\fP (string)
Specify the namespace from the Amazon EKS cluster with which the IAM Role would be used.
.sp
\fB\-\-role\-name\fP (string)
Specify the IAM Role name that you want to usewith Amazon EMR on EKS.
.sp
\fB\-\-iam\-endpoint\fP (string)
The IAM endpoint to call for updating the role trust policy. This is optional and should only bespecified when a custom endpoint should be calledfor IAM operations.
.sp
\fB\-\-dry\-run\fP (boolean)
Print the merged trust policy document tostdout instead of updating the role trustpolicy directly.
.sp
See \(aqaws help\(aq for descriptions of global parameters.
.SH EXAMPLES
.sp
\fBTo update the trust policy of an IAM Role to be used with Amazon EMR on EKS\fP
.sp
This example command updates the trust policy of a role named \fBexample_iam_role\fP such that it can be used with Amazon EMR on EKS with
\fBexample_namespace\fP namespace from an EKS cluster named \fBexample_cluster\fP\&.
.INDENT 0.0
.IP \(bu 2
Command:
.INDENT 2.0
.INDENT 3.5
.sp
.nf
.ft C
aws emr\-containers update\-role\-trust\-policy \e
    \-\-cluster example_cluster \e
    \-\-namespace example_namespace \e
    \-\-role\-name example_iam_role
.ft P
.fi
.UNINDENT
.UNINDENT
.IP \(bu 2
Output:
.INDENT 2.0
.INDENT 3.5
.sp
.nf
.ft C
If the trust policy has already been updated, then the output will be:
Trust policy statement already exists for role example_iam_role. No
changes were made!

If the trust policy has not been updated yet, then the output will be:
Successfully updated trust policy of role example_iam_role.
.ft P
.fi
.UNINDENT
.UNINDENT
.UNINDENT
.\" Generated by docutils manpage writer.
.
